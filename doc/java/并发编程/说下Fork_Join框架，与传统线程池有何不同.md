# 说下Fork/Join框架，与传统线程池有何不同

Fork/Join框架是一个**用于并行化执行任务的框架**，它是Java 7引入的一个新特性，专门用于方便地利用多核CPU的性能优势，通过分治法的策略来将任务分解为更小的子任务，然后并行执行这些子任务，最后再合并子任务的结果。
Fork/Join框架的核心是ForkJoinPool，它是一种特殊的线程池，它使用工作窃取算法（Work-Stealing）来平衡负载，使得每个线程尽可能均匀地执行任务。ForkJoinPool中维护了一个任务队列（WorkQueue），当一个线程执行完一个任务时，它会尝试从队列中取出一个新的任务来执行。如果队列为空，它会尝试从其他线程的任务队列中“窃取”任务。这种工作窃取算法使得任务能够被高效地重新分配，从而最大限度地利用系统资源。
与传统的线程池相比，Fork/Join框架具有以下不同：

1. **自动并行化**：Fork/Join框架可以自动将任务分解为多个子任务，并并行执行这些子任务。这是通过Fork/Join框架的分治法策略实现的。而传统的线程池则需要程序员手动地将任务分解为多个子任务，并且需要自行管理这些子任务的执行。
2. **工作窃取算法**：Fork/Join框架使用工作窃取算法来平衡负载，使得每个线程尽可能均匀地执行任务。这种算法可以有效地重新分配任务，从而最大限度地利用系统资源。而传统的线程池则没有这种算法，它只是简单地按照先来先服务的原则执行任务。
3. **集成阻塞队列**：Fork/Join框架集成了阻塞队列（BlockingQueue），这种队列可以在需要时自动阻塞线程，直到队列中有新的任务可供执行。这种集成使得Fork/Join框架可以更高效地管理任务队列。而传统的线程池则需要程序员自行管理任务队列，或者使用其他第三方库来实现阻塞队列的功能。

总之，Fork/Join框架是一种专门用于并行化执行任务的框架，它通过分治法策略和自动并行化功能，使得程序员可以更方便地利用多核CPU的性能优势。与传统的线程池相比，Fork/Join框架具有更高的效率和更方便的使用方式。


> 原文: <https://www.yuque.com/tulingzhouyu/db22bv/dhtcg0ffl7ssyp1t>
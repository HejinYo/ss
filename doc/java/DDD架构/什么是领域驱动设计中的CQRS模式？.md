# 什么是领域驱动设计中的 CQRS 模式？

领域驱动设计（DDD）中的CQRS模式是一种架构模式，它将系统中的操作分为两类：命令（Command）与查询（Query）。CQRS 模式强调了应用程序要将命令和查询愤慨处理。

- 命令是对会引起数据发生变化的操作的总称，如新增、更新、删除等操作。命令通常是不返回数据的，它们只用于触发状态变化。
- 查询则是对不会对数据产生变化的操作的总称，例如按照某些条件查找数据。它们用于获取系统状态的快照或特定信息。查询通常返回数据给客户端

在CQRS模式中，命令和查询应在两个独立的系统中处理，这两个系统一般是指两个独立部署的应用程序，在某些特殊情况下，也可以部署在同一个应用内的不同接口上。通过分离职责、使用不同的数据存储和事件驱动的方式，允许更好地满足系统的性能和可伸缩性需求。
在使用CQRS模式时，通常也需要面临一些问题，例如事务和查询模型的设计。在事务方面，由于命令和查询分别在不同的系统中处理，因此需要解决时间差问题以及更新操作失败可能导致的数据不一致性问题。在查询模型设计方面，需要解决查询接口过多的问题，可以将属于同一领域的查询集中管理作为整个查询系统的一个上下文，或者将它们独立出来作为一个微服务。
总之，在DDD中，CQRS模式可以将领域模型与查询功能进行分离，使一些复杂的查询摆脱领域模型的限制，以更为简单的DTO形式展现查询结果。同时也可以分离不同的数据存储结构，使开发者更加自由地选择数据存储引擎。虽然引入CQRS模式会引入额外的复杂性和技能要求，但在面对大型业务系统和复杂的业务流程时，使用CQRS模式可以帮助将命令和查询进行拆分，使领域模型与数据模型的边界更加清晰。


> 原文: <https://www.yuque.com/tulingzhouyu/db22bv/qbpaiq7m9eybl51b>
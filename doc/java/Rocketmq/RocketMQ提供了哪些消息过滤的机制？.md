# RocketMQ 提供了哪些消息过滤的机制？

RocketMQ消息过滤分为两种：基于表达式的过滤和基于类模式的过滤。
基于表达式的过滤有两种模式：TAG模式和SQL92模式。其中，RocketMQ 允许为每一条消息设置一个 Tag 标签。

- TAG 模式下，Consumer 可以选择订阅特定的 TAG，对消息进行过滤。TAG模式根据消息的属性进行过滤，适合于简单的场景；SQL92模式可以支持更复杂的逻辑，可以使用SQL92的语法进行过滤。这种过滤方式由于是在 ConsumeQueue 文件中直接进行过滤，所以性能比较高。
- SQL92 模式下，Consumer 可以通过设定一个满足 SQL92 标准的 SQL 语句，定制相对比较复杂的过滤逻辑，例如数值比较等。同时，也可以引用消息中添加的其他自定义属性，定制多维度的过滤条件组合。

基于类模式的过滤是使用用户自定义的过滤器类来实现消息过滤。消费者可以在消息监听器中编写自定义逻辑来实现更复杂的消息过滤机制。在这种模式下，消费者可以完全控制消息的过滤逻辑，适用于需要导读定制和特殊处理的场景。但是同样，对Consumer 的编码能力要求更高。
RocketMQ 在进行消息过滤时，都会将消息过滤的逻辑上推到 Broker 端执行。这样可以减少不必要的网络数据传递。但是，同时也会给 Broker 增加业务复杂性。因此，客户端需要根据不同的业务场景，选择合适的过滤机制。



> 原文: <https://www.yuque.com/tulingzhouyu/db22bv/quouet2xt6b2k15h>
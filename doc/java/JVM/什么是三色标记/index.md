# 什么是三色标记

三色标记是一种用于并发垃圾收集的算法，常用于分代垃圾收集器中的老年代的垃圾回收过程中。它基于对象的可达性来判断对象是否存活，并标记出存活对象。
三色标记算法将对象分为三种状态：白色、灰色和黑色。
白色表示对象尚未被扫描，即未被标记为存活对象。
灰色表示对象已经被扫描，但其引用的其他对象尚未被扫描。
黑色表示对象已经被扫描，并且其引用的其他对象也已经被扫描。
垃圾收集器在开始垃圾回收时，将所有对象标记为白色。然后从根对象开始，递归地遍历对象图，将遇到的对象标记为灰色，并将其引用的对象添加到待扫描队列中。接着，垃圾收集器从待扫描队列中取出对象，将其标记为黑色，并将其引用的对象添加到待扫描队列中。这个过程会一直进行，直到待扫描队列为空。
最后，所有未被标记为黑色的对象即为垃圾对象，可以被回收。
三色标记算法的优点是可以在并发执行的情况下进行垃圾回收，减少停顿时间。它通过将对象分为三种状态，避免了在并发执行过程中的同时修改和访问对象的冲突。然而，三色标记算法也有一些缺点，如可能存在标记漏标和标记误标的情况，需要额外的处理来解决这些问题。


> 原文: <https://www.yuque.com/tulingzhouyu/db22bv/sguahv8u1s2tckek>